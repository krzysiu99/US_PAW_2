<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jstl/core">
	
<f:metadata>
    <f:viewAction action="#{postBB.onLoad()}" />
</f:metadata>
	
	
<h:head>
	<title>Pokaż post</title>
</h:head>
<h:body>
	<ui:composition template="/templemate/szablon.xhtml">
		<ui:define name="strona">
		
			<h:form rendered="#{postBB.post != null}">
			    <p:panel>
			    	<f:facet name="header">
			        	#{postBB.post.tytul}
			        </f:facet>
			        <p class="p-m-0">
			            #{postBB.post.tresc}
			        </p>
			        <f:facet name="actions">
			        	<p:link outcome="Uzytkownik" value="autor: #{postBB.post.uzytkownik.nick}">
					        <f:param name="uid" value="#{postBB.post.uzytkownik.uid}"/>
					    </p:link>
			        </f:facet>
			        <f:facet name="footer">
			        	<p:link outcome="Kategoria" value="#{postBB.post.kategoria}">
					        <f:param name="nazwa" value="#{postBB.post.kategoria}"/>
					    </p:link>
					    <span class="right">#{postBB.post.dataPublikacji}</span>
			        </f:facet>
			    </p:panel>
			    
			    <h1>Komentarze do tego postu</h1>
			    
			    <ui:repeat value="#{postBB.list}" var="k">
				    <p:panel>
				    	<f:facet name="header">
				        	<p:link outcome="Uzytkownik" value="autor: #{k.uzytkownik.nick}">
						        <f:param name="uid" value="#{k.uzytkownik.uid}"/>
						    </p:link>
				        </f:facet>
				        <p class="p-m-0">
				            #{k.tresc}
				        </p>
				        <c:if test="#{not empty remoteClient.details.nick and (remoteClient.details.rola == '0' or remoteClient.details.nick == k.uzytkownik.nick)}">
				        <p class="edycja">
							<p:commandButton value="Usuń"
								action="#{postBB.kasujKomentarz(k)}" update="@form" />
				        </p>
				        </c:if>
				        <f:facet name="footer">
				        	#{k.czasPublikacji}
				        </f:facet>
				    </p:panel>
		    	</ui:repeat>
			    
			    
			  </h:form>
			
		</ui:define>
	</ui:composition>

</h:body>
</html>